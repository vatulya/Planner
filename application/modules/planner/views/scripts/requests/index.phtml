<?php $this->headScript()->appendFile('/js/requests.js'); ?>
<?php $this->headScript()->appendFile('/js/calendar.js'); ?>
<?php $this->headLink()->appendStylesheet('/css/calendar.css'); ?>

<?php
$oldSelectedDates = array();
foreach ($this->userRequests as $request) {
    $oldSelectedDates[] = $request['request_date'];
};
?>

<div class="span4">
    <?php echo $this->me['full_name']; ?>
</div>
<div class="span4">
    <span class="param-name">Gebruikt saldo:</span> <span class="use-free-hours"><?php echo $this->me['parameters']['used_free_hours']; ?></span>
</div>
<div class="span4">
    <span class="param-name">Openstaand saldo:</span> <span class="allowed-free-hours"><?php echo $this->me['parameters']['allowed_free_hours']; ?></span>
</div>

<div class="span12" id="request-calendar-container">
    <div class="span12">
        <div
            class="module-calendar"
            data-old-selected-dates="<?php echo implode(',', $oldSelectedDates); ?>"
            data-selected-dates=""
            data-container-id="request-calendar-container"
            data-editable="1"
        ></div>
    </div>
    <div class="span12">
        <span class="param-name">Geselecteerd is:</span> <span class="request-calendar-selected-days"></span>
    </div>
    <div class="span6">
        <input class="btn btn-success pull-right" type="button" id="save-request" value="Submit">
    </div>
</div>

<div class="span12">
    <table class="table requests-table table-hover">
        <tbody>
        <tr>
            <td class="span3">
                Openstaande aanvragen:
            </td>
            <td>
                <?php echo implode(', ', $oldSelectedDates); ?>
            </td>
            <td>
                <button class="btn show-in-calendar pull-right"
                    data-old-selected-dates="<?php echo implode(',', $oldSelectedDates); ?>"
                    data-show-date="<?php echo end($oldSelectedDates); ?>"
                ><span class="icon-eye-open"></span></button>
            </td>
        </tr>
        <tr>
            <td class="span3">
                Geaccordeerde aanvragen:
            </td>
            <td>
                07-06-2012, 08-06-2012
            </td>
            <td>
                <button class="btn show-in-calendar pull-right" data-selected-dates='2013-02-05' data-show-date='2013-02-01'><span class="icon-eye-open"></span></button>
            </td>
        </tr>
        <tr>
            <td class="span3">
                Afgewezen dagen:
            </td>
            <td>
                05-02-2013
            </td>
            <td>
                <button class="btn show-in-calendar pull-right" data-selected-dates='2013-02-05' data-show-date='2013-02-01'><span class="icon-eye-open"></span></button>
            </td>
        </tr>
        <tr>
            <td class="span3">
                Historische dagen dit jaar:
            </td>
            <td>
            </td>
            <td>
                <button class="btn show-in-calendar pull-right" data-selected-dates='2013-02-05' data-show-date='2013-02-01'><span class="icon-eye-open"></span></button>
            </td>
        </tr>
        </tbody>
    </table>
</div>